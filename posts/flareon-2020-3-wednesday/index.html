<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=author content>
<meta name=description content>
<meta name=keywords content>
<meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name=generator content="Hugo 0.88.1">
<link rel=canonical href=https://starfleetcadet75.github.io/posts/flareon-2020-3-wednesday/>
<meta property="og:title" content="Flare-On CTF 2020 Challenge 3: wednesday">
<meta property="og:description" content="Unlike challenge 1, you probably won&rsquo;t be able to beat this game the old fashioned way.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://starfleetcadet75.github.io/posts/flareon-2020-3-wednesday/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-09-20T00:00:00+00:00">
<meta property="article:modified_time" content="2020-09-20T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Flare-On CTF 2020 Challenge 3: wednesday">
<meta name=twitter:description content="Unlike challenge 1, you probably won&rsquo;t be able to beat this game the old fashioned way.">
<meta itemprop=name content="Flare-On CTF 2020 Challenge 3: wednesday">
<meta itemprop=description content="Unlike challenge 1, you probably won&rsquo;t be able to beat this game the old fashioned way."><meta itemprop=datePublished content="2020-09-20T00:00:00+00:00">
<meta itemprop=dateModified content="2020-09-20T00:00:00+00:00">
<meta itemprop=wordCount content="311">
<meta itemprop=keywords content="reversing,">
<link rel=stylesheet href=/css/layout.css>
<link rel=stylesheet href=/css/default-dark.css>
<link rel=stylesheet href=/css/adoc-html5-extension.css>
<title>
Flare-On CTF 2020 Challenge 3: wednesday
</title>
</head>
<body>
<div class=main>
<header>
<div class=header-bar>
<nav>
<div class=siteTitle>
<a href=https://starfleetcadet75.github.io/>starfleetcadet75</a>
</div>
<a class=nav-item href=/about/><div class=nav-item-title>About</div></a>
<a class=nav-item href=/readinglist/><div class=nav-item-title>Reading List</div></a>
<a class="nav-item active" href=/posts/><div class=nav-item-title>Posts</div></a>
</nav>
<div class=social-links-header style=visibility:hidden;display:none>
<a href=mailto:starfleetcadet75@gmail.com><div class=social-link>email</div></a>
<a href=https://github.com/starfleetcadet75 target=_blank><div class=social-link>gh</div></a>
<a href=https://gitlab.com/starfleetcadet75 target=_blank><div class=social-link>gl</div></a>
</div>
</div>
</header>
<article class=post>
<h1 class=title> Flare-On CTF 2020 Challenge 3: wednesday </h1>
<div class=content> <h2 id=challenge>Challenge</h2>
<blockquote>
<p>Be the wednesday.
Unlike challenge 1, you probably won&rsquo;t be able to beat this game the old fashioned way.
Read the README.txt file, it is very important.</p>
</blockquote>
<h2 id=observations>Observations</h2>
<p>The provided program is a simple game that requires the player to either jump over or crouch under different lettered blocks.
The README states that only mydude.exe needs to be reversed and hints at the game rules with a diagram.
Experimenting with the game, it appears that the player must jump over any Sunday, Monday, or Tuesday blocks and crouch under any Thursday, Friday, or Saturday blocks otherwise the game will end.
In order to beat the game, we will probably need to reach a certain score that would be unattainable without cheating.</p>
<h2 id=reversing-the-program>Reversing the Program</h2>
<p>The program is on the larger side but fortunately still contains useful symbol data.
A quick glance through the symbols leads us to <code>_winScene__eVaCVkG1QBiYVChMxpMGBQ</code>.
When the player successfully wins the game, the program uses this pointer to display the win scene.
It is possible to force the win scene to appear by manually putting the value of this pointer into <code>eip</code> in a debugger.
This will not display the flag however.</p>
<p>One of the cross references to this pointer comes from the <code>@update__Arw3f6ryHvqdibU49aaayOg@12</code> function.
Examining where it is used indicates how the win scene gets triggered by the game.</p>
<p><img src=https://raw.githubusercontent.com/starfleetcadet75/writeups/master/2020-Flareon-CTF/wednesday/score.png alt=score></p>
<p>The conditional branch before the call checks that the player&rsquo;s score is equal to 296.</p>
<p>Another interesting symbol is <code>_score__h34o6jaI3AO6iOQqLKaqhw</code>.
This is the location where the player&rsquo;s score is kept in memory.
Looking at the cross references, we can see that the score is incremented in the <code>onCollide</code> function.</p>
<p><img src=https://raw.githubusercontent.com/starfleetcadet75/writeups/master/2020-Flareon-CTF/wednesday/score_increment.PNG alt=score_increment></p>
<p>We can force the game to increment the score for every obstacle passed regardless of player movement by patching the conditional branch to always succeed.
Now we can hold down crouch and wait until our score reaches 296.</p>
<p><img src=https://raw.githubusercontent.com/starfleetcadet75/writeups/master/2020-Flareon-CTF/wednesday/flag.png alt=flag></p>
</div>
<footer class=post-footer>
<div class=post-footer-data>
<div class=tags>
<div class=tag>
<a href=/tags/reversing>#reversing</a>
</div>
</div>
<div class=post-footer-meta>Permalink: <a href=https://starfleetcadet75.github.io/posts/flareon-2020-3-wednesday/>/posts/flareon-2020-3-wednesday/</a> | Date: 2020-09-20 </div>
<hr>
<div class=categories>
Published in:
<div class=category>
<a href=/categories/writeups>writeups</a>
</div>
</div>
<div class=series>
</div>
</div>
</footer>
</article>
<footer>
<div class=social-links-footer>
<a href=mailto:starfleetcadet75@gmail.com><div class=social-link>Email</div></a>
<a href=https://github.com/starfleetcadet75 target=_blank><div class=social-link>GitHub</div></a>
<a href=https://gitlab.com/starfleetcadet75 target=_blank><div class=social-link>GitLab</div></a>
<div class=social-link>
<a href=https://starfleetcadet75.github.io/index.xml target=_blank>RSS</a>
</div>
</div>
<div class=copyright> </div>
<div class=poweredby>
Powered by <a href=https://gohugo.io/>Hugo</a>.
</div>
</footer>
</div>
</body>
</html>